<section class="sectionClient">
  <div class="section-title">
    <h3>TUS CLIENTES</h3>
  </div>
  <div class="search">
    <figure class="icon">
      <app-create-icon [class]="'color-gray'" [name]="'search'" [url]="'../../../../assets/svg/buscar.svg'"></app-create-icon>
    </figure>
    <input type="search" placeholder="Buscar">
  </div>
  <div class="list">
    <div class="client__contain" *ngFor="let client of allClients">
      <div class="client__contain--title">
        <h4>{{client.numClient}}</h4>
        <p>{{client.name}}</p>
        <p>{{client.createdAt | date}}</p>
      </div>
      <div>
        <div class="client__contain--icon mb-3" (click)="showOptions(EDITUSER)">
          Editar
        </div>
        <div class="client__contain--icon" (click)="showOptions(SERVICES)">
          Servicios
        </div>
      </div>
    </div>
    <div class="client__contain" *ngIf="!allClients">
      <div class="client__contain--title d-flex justify-content-center text-center w-100">
        <h4>No existen clientes</h4>
      </div>
    </div>
  </div>
</section>

<section class="containService" *ngIf="show === OPTIONS">
  <form class="p-3 form" #userForm="ngForm" *ngIf="showView === EDITUSER">
    <div class="containService__data">
      <div class="whenService d-flex justify-content-between pb-2">
        <div class="client">
          <div class="input__contain">
            <label for="">N° cliente</label>
            <p>#{{newClient.numClient}}</p>
          </div>
        </div>
      </div>
      <div class="dataService d-flex justify-content-between pt-4 pb-2">
        <div class="input__contain name">
          <label for="">Nombre(s)</label>
          <input type="text" placeholder="Nombre" name="names" [(ngModel)]="newClient.name" required>
        </div>
        <div class="input__contain">
          <label for="">Apellido Paterno</label>
          <input type="text" placeholder="Apellido Paterno" name="lastname" [(ngModel)]="newClient.lastName" required>
        </div>
        <div class="input__contain">
          <label for="">Apellido Materno</label>
          <input type="text" placeholder="Apellido Materno" name="lastnameMother" [(ngModel)]="newClient.motherLastName" required>
        </div>
        <div class="input__contain name">
          <label for="">Nombre empresa</label>
          <input type="text" placeholder="Nombre" name="nameCompany" [(ngModel)]="newClient.nameCompany" required>
        </div>
      </div>
      <div class="dataService d-flex justify-content-between pt-4 pb-2">
        <div class="input__contain name">
          <label for="">NIF</label>
          <input type="text" placeholder="A0000000" name="nif" [(ngModel)]="newClient.nif" required>
        </div>
        <div class="input__contain">
          <label for="">Correo Electrónico</label>
          <input type="email" pattern="[\w0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$" placeholder="correo@correo.com" name="email" [(ngModel)]="newClient.email" required>
        </div>
        <div class="input__contain">
          <label for="">Teléfono 1</label>
          <input type="text" minlength="7" pattern="^[0-9]*$" placeholder="000 000 000" name="numberOne" [(ngModel)]="newClient.phoneOne" required>
        </div>
        <div class="input__contain">
          <label for="">Teléfono 2</label>
          <input type="text" minlength="7" pattern="^[0-9]*$" placeholder="000 000 000" name="numberTwo" [(ngModel)]="newClient.phoneTwo" required>
        </div>
      </div>
      <div class="direccion">
        <h3 class="title">DIRECCIÓN (De quien contrata el servicio)</h3>
        <div class="direccion__contain">
          <div class="d-flex justify-content-between align-items-center flex-wrap">
            <div class="input__contain">
              <label for="">Dirección</label>
              <input type="text" class="w-200" placeholder="Dirección" name="localitation" [(ngModel)]="newClient.direction" required>
            </div>
            <div class="input__contain">
              <label for="">Número externo</label>
              <input type="text" class="max-width-95" placeholder="00" name="numExt" [(ngModel)]="newClient.numberExternal" required>
            </div>
            <div class="input__contain">
              <label for="">Número interno</label>
              <input type="text" class="max-width-95" placeholder="00" name="numInt" [(ngModel)]="newClient.numberInternal" required>
            </div>
            <div class="input__contain">
              <label for="">Provincia</label>
              <select class="w-200" name="province" [(ngModel)]="newClient.province" required>
                <option value="">Selecciona Provincia</option>
                <option *ngFor="let option of optionsProvince"  [value]="option">{{option}}</option>
              </select>
            </div>
          </div>
          <div class="d-flex align-items-center flex-wrap pt-4">
            <div class="input__contain mr-12">
              <label for="">Municipio</label>
              <select class="w-100" name="municipality" [(ngModel)]="newClient.municipality">
                <option value="">Selecciona Municipio</option>
                <option *ngFor="let option of optionsMunicipality" [value]="option">{{option}}</option>
              </select>
            </div>
            <div class="input__contain code">
              <label for="">Código postal</label>
              <input class="w-100" type="text" placeholder="Código postal" name="postalcode" [(ngModel)]="newClient.postalCode" required>
            </div>
          </div>
        </div>
      </div>
    </div>
    <aside class="containService__aside">
      <div>
        <div class="buttons d-flex justify-content-center align-items-center">
          <button  class="buttonSave">
            Actualizar
          </button>
        </div>
      </div>
    </aside>
  </form>
  <div class="services" *ngIf="showView === SERVICES">
    <div class="services__header">
      <h3>Servicios</h3>
      <div>
        <button class="button" (click)="showView = EDITSERVICE">Crear Nuevo</button>
      </div>
    </div>
    <div class="services__main">
      <div class="service" *ngFor="let service of allServiceOfClient">
        <div class="left">
          <div class="one">
            <p>#{{service.numService}}</p>
            <p>{{service.dateStart}}</p>
          </div>
          <div>
            <p>{{service.name}}</p>
          </div>
        </div>
        <div class="button">
          <button (click)="showView = EDITSERVICE">Editar</button>
        </div>
      </div>
    </div>
  </div>
  <form class="p-3 form" *ngIf="showView === EDITSERVICE">
    <div class="containService__data">
      <div>
        <h3 class="title">DATOS DEL SERVICIO</h3>
      </div>
      <div class="d-flex justify-content-between flex-wrap mt-4">
        <div class="d-flex justify-content-between align-items-center flex-wrap w-100">
          <div class="input__contain dateContain">
            <label for="" class="w-50">N° de Servicio</label>
            <input class="w-100" type="text" placeholder="000000" name="numService" [(ngModel)]="newService.numService" required>
          </div>
          <div class="input__contain dateContain">
            <label for="" class="w-50">N° de Factura</label>
            <input class="w-100" type="text" placeholder="000000" name="numBill" [(ngModel)]="newService.numBill" required>
          </div>
          <div class="input__contain dateContain">
            <label for="" class="w-50">Fecha</label>
            <input class="w-100" type="date" name="date" [(ngModel)]="newService.startDate" placeholder="00/00/0000" required>
          </div>
          <div class="input__contain">
            <label for="">Hora</label>
            <input type="time" placeholder="00:00" name="hour" [(ngModel)]="newService.startHours" required>
          </div>
          <div class="input__contain">
            <label for="" class="color-red">Urgente</label>
            <select class="border-red" name="priority" [(ngModel)]="newService.priority" required>
              <option value="true">SI</option>
              <option value="false">NO</option>
            </select>
          </div>
        </div>
        <div class="statusService d-flex justify-content-between flex-wrap w-100 pt-4">
          <div class="input__contain">
            <label for="">Importe</label>
            <input type="text" pattern="^[0-9]*$" placeholder="0000 €" name="amount" [(ngModel)]="newService.amount" required>
          </div>
          <div class="input__contain">
            <label for="">Tipo IVA</label>
            <select class="w-100" name="status" [(ngModel)]="newService.status" required>
              <option value="">Normal</option>
              <option *ngFor="let option of optionsStatus" [value]="option">{{option}}</option>
            </select>
          </div>
          <div class="input__contain">
            <label for="">Estado</label>
            <select class="w-100" name="status" [(ngModel)]="newService.status" required>
              <option value="">Selecciona un estado</option>
              <option *ngFor="let option of optionsStatus" [value]="option">{{option}}</option>
            </select>
          </div>
          <div class="input__contain">
            <label for="">Actividad</label>
            <select class="w-100" name="activities" [(ngModel)]="newService.activities" required>
              <option value="">Selecciona una o varias</option>
              <option *ngFor="let option of optionsActivities" [value]="option">{{option}}</option>
            </select>
          </div>
        </div>
        <div class="descriptionService w-100 d-flex justify-content-center pt-3">
          <div class="input__contain w-75 mr-5">
            <label for="">Descripción</label>
            <textarea class="w-100 h-85" name="description" [(ngModel)]="newService.description" cols="30" rows="10" placeholder="Descripción del trabajo sin Nota interna" required></textarea>
          </div>
          <div class="input__contain">
            <label for="">Incluye <b>Nota interna</b></label>
            <textarea class="w-100 h-85" name="note" [(ngModel)]="newService.note" cols="30" rows="10" placeholder="escribe una breve nota interna"></textarea>
          </div>
        </div>
      </div>
    </div>
    <aside class="containService__aside saveService flex-column">
      <div class="addEmployee">
        <div class="input__contain">
          <label for=""><b>Asigna el trabajo</b></label>
          <select class="w-100" name="workers" [(ngModel)]="newService.workers" *ngIf="allUsers">
            <option value="">Busca tu trabajador</option>
            <option *ngFor="let option of allUsers"  [value]="option._id">{{option.name}}</option>
          </select>  
          <p *ngIf="!allUsers" class="no-exist w-100"><b>No existen trabajadores</b></p>
        </div>
      </div>
      <!-- <div class="mt-3">
        <div class="buttons d-flex align-items-center flex-wrap">
          <button  class="buttonSave" (click)="createServiceAndSendPDF()">
            Guardar y Enviar al cliente<br>
            (en PDF)
          </button>
        </div>
        <div class="buttons w-50 d-flex align-items-center">
          <button  class="buttonSave" (click)="createService()">
            Guardar y Agendar <br>
            <figure class="icon">
              <app-create-icon [class]="'color-gray bg-white button p-2x'" [name]="'calendar'" [url]="'../../../assets/svg/calendario.svg'"></app-create-icon>
            </figure>
          </button>
        </div>
      </div> -->
    </aside>
  </form>
</section>